<!--
  templateType: module
  label: Team Cards
  isAvailableForNewContent: true
-->

<style>
  /* Team Cards Module - Uses Brand CSS Variables */

  .team-cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-24, 24px);
    width: 100%;
  }

  .team-card {
    position: relative;
  }

  .team-card__image-wrapper {
    width: 100%;
    aspect-ratio: 4 / 5;
    border-radius: var(--border-radius-md, 8px);
    overflow: hidden;
    margin-bottom: var(--space-16, 16px);
  }

  .team-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .team-card__header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: var(--space-16, 16px);
    width: 100%;
    cursor: pointer;
  }

  .team-card__header:hover .team-card__expand-icon {
    opacity: 0.7;
  }

  .team-card__info {
    flex: 1;
    min-width: 0;
  }

  .team-card__name-title {
    font-family: var(--font-body, 'Inter', sans-serif);
    font-size: var(--font-size-body, 16px);
    font-weight: var(--font-weight-semibold, 600);
    line-height: var(--line-height-normal, 1.5);
    color: var(--color-text-primary, #161616);
    margin: 0;
  }

  /* Expand icon container */
  .team-card__expand-icon {
    flex-shrink: 0;
    width: 18px;
    height: 18px;
    margin-top: 3px;
    transition: opacity var(--transition-duration, 0.2s) ease;
  }

  .team-card__expand-icon svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .team-card__expand-icon svg circle {
    fill: var(--color-text-primary, #161616);
  }

  /* Toggle between plus and minus icons */
  .team-card__expand-icon svg.team-card__expand-icon--plus {
    display: block !important;
  }

  .team-card__expand-icon svg.team-card__expand-icon--minus {
    display: none !important;
  }

  .team-card.is-open .team-card__expand-icon svg.team-card__expand-icon--plus {
    display: none !important;
  }

  .team-card.is-open .team-card__expand-icon svg.team-card__expand-icon--minus {
    display: block !important;
  }

  /* Accordion expansion */
  .team-card__bio {
    max-height: 0;
    overflow: hidden;
    transition: max-height var(--transition-duration, 0.3s) ease;
  }

  .team-card.is-open .team-card__bio {
    max-height: 2000px;
  }

  .team-card__bio-inner {
    padding: var(--space-16, 16px) 0 0 0;
    font-family: var(--font-body, 'Inter', sans-serif);
    font-size: var(--font-size-body-small, 14px);
    font-weight: var(--font-weight-regular, 450);
    line-height: var(--line-height-relaxed, 1.6);
    color: var(--color-text-secondary, #525252);
  }

  .team-card__bio-inner p {
    margin: 0 0 var(--space-12, 12px) 0;
  }

  .team-card__bio-inner p:last-child {
    margin: 0;
  }

  .team-card__bio-inner ul,
  .team-card__bio-inner ol {
    margin: 0 0 var(--space-12, 12px) 0;
    padding-left: var(--space-20, 20px);
  }

  .team-card__bio-inner li {
    margin-bottom: var(--space-4, 4px);
  }

  /* Tablet adjustments */
  @media (max-width: 1023px) {
    .team-cards {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-16, 16px);
    }
  }

  /* Mobile adjustments */
  @media (max-width: 767px) {
    .team-cards {
      grid-template-columns: 1fr;
      gap: var(--space-24, 24px);
    }
  }
</style>

<div class="team-cards">
  {% for member in module.team_members %}
    <div class="team-card" data-team-card>
      <div class="team-card__image-wrapper">
        {% if member.photo.src %}
          <img
            src="{{ member.photo.src }}"
            alt="{{ member.photo.alt or member.member_name }}"
            class="team-card__image"
            loading="lazy"
          />
        {% endif %}
      </div>
      <div class="team-card__header" data-expand-header role="button" tabindex="0" aria-expanded="false" aria-label="View {{ member.member_name }} details">
        <div class="team-card__info">
          <div class="team-card__name-title">{{ member.member_name }}, {{ member.title }}</div>
        </div>
        <div class="team-card__expand-icon">
          <!-- Plus Icon (collapsed) -->
          <svg class="team-card__expand-icon--plus" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="3" cy="9" r="2"/>
            <circle cx="9" cy="3" r="2"/>
            <circle cx="9" cy="9" r="2"/>
            <circle cx="9" cy="15" r="2"/>
            <circle cx="15" cy="9" r="2"/>
          </svg>
          <!-- Minus Icon (expanded) -->
          <svg class="team-card__expand-icon--minus" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="3" cy="9" r="2"/>
            <circle cx="9" cy="9" r="2"/>
            <circle cx="15" cy="9" r="2"/>
          </svg>
        </div>
      </div>
      {% if member.bio %}
        <div class="team-card__bio" data-bio-content>
          <div class="team-card__bio-inner">
            {{ member.bio }}
          </div>
        </div>
      {% endif %}
    </div>
  {% endfor %}
</div>

<script>
  (function() {
    function initTeamCards() {
      const cards = document.querySelectorAll('[data-team-card]');

      if (cards.length === 0) return;

      cards.forEach(card => {
        const expandHeader = card.querySelector('[data-expand-header]');

        if (expandHeader) {
          // Handle click
          expandHeader.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleCard(card, expandHeader);
          });

          // Handle keyboard (Enter or Space)
          expandHeader.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              e.stopPropagation();
              toggleCard(card, expandHeader);
            }
          });
        }
      });
    }

    function toggleCard(card, expandHeader) {
      const isOpen = card.classList.contains('is-open');

      if (isOpen) {
        card.classList.remove('is-open');
        expandHeader.setAttribute('aria-expanded', 'false');
      } else {
        card.classList.add('is-open');
        expandHeader.setAttribute('aria-expanded', 'true');
      }
    }

    // Initialize on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initTeamCards);
    } else {
      initTeamCards();
    }
  })();
</script>
